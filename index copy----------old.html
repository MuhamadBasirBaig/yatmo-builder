<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yatmo Plugin Generator</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="header">
        <div class="container">
            <h1 class="mb-0"><i class="bi bi-geo-alt-fill"></i> Yatmo Plugin Generator</h1>
            <p class="mb-0 mt-2">Configure your Yatmo plugin and copy/paste the generated code. This code can be added to any website, CRM, etc.<br>
            Just ensure you can update the configuration like the latitude/longitude, the country, etc. depending on the page where you will paste this code.</p>
        </div>
    </div>

    <div class="container">
        <div class="row">
            <div class="col-lg-8">
                <div class="config-section">
                    <div class="head">
                        <h2>Configuration</h2>
                    </div>
                    <div class="body">
                        <form id="pluginForm">
                            <div class="accordion" id="configAccordion">
                                <!-- Map Style -->
                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseMapStyle" aria-expanded="true" aria-controls="collapseMapStyle">
                                            <i class="bi bi-palette-fill text-primary me-2"></i> Map style
                                        </button>
                                    </h2>
                                    <div id="collapseMapStyle" class="accordion-collapse collapse show" data-bs-parent="#configAccordion">
                                        <div class="accordion-body">
                                            <div class="radio-group">
                                                <div class="radio-option">
                                                    <input type="radio" name="mapStyle" id="style1" value="1" checked>
                                                    <label for="style1">Style 1</label>
                                                </div>
                                                <div class="radio-option">
                                                    <input type="radio" name="mapStyle" id="style2" value="2">
                                                    <label for="style2">Style 2</label>
                                                </div>
                                                <div class="radio-option">
                                                    <input type="radio" name="mapStyle" id="style3" value="3">
                                                    <label for="style3">Style 3</label>
                                                </div>
                                                <div class="radio-option">
                                                    <input type="radio" name="mapStyle" id="style4" value="4">
                                                    <label for="style4">Style 4</label>
                                                </div>
                                                <div class="radio-option">
                                                    <input type="radio" name="mapStyle" id="style5" value="5">
                                                    <label for="style5">Style 5</label>
                                                </div>
                                            </div>
                                            <div class="hint">Select the base map theme used by the plugin.</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Mode -->
                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseMode" aria-expanded="false" aria-controls="collapseMode">
                                            <i class="bi bi-layout-split text-primary me-2"></i> Mode
                                        </button>
                                    </h2>
                                    <div id="collapseMode" class="accordion-collapse collapse" data-bs-parent="#configAccordion">
                                        <div class="accordion-body">
                                            <div class="radio-group">
                                                <div class="radio-option">
                                                    <input type="radio" name="mode" id="mode1" value="together" checked>
                                                    <label for="mode1">Map + summary together (summary overlays map)</label>
                                                </div>
                                                <div class="radio-option">
                                                    <input type="radio" name="mode" id="mode2" value="top">
                                                    <label for="mode2">Map on top of summary</label>
                                                </div>
                                                <div class="radio-option">
                                                    <input type="radio" name="mode" id="mode3" value="map">
                                                    <label for="mode3">Only map</label>
                                                </div>
                                                <div class="radio-option">
                                                    <input type="radio" name="mode" id="mode4" value="summary">
                                                    <label for="mode4">Only summary</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Country and Language -->
                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseCountryLanguage" aria-expanded="false" aria-controls="collapseCountryLanguage">
                                            <i class="bi bi-globe text-primary me-2"></i> Country & Language
                                        </button>
                                    </h2>
                                    <div id="collapseCountryLanguage" class="accordion-collapse collapse" data-bs-parent="#configAccordion">
                                        <div class="accordion-body">
                                            <div class="row">
                                                <div>
                                                    <label for="country" class="form-label">Country</label>
                                                    <select class="form-select" id="country" name="country">
                                                        <option value="BE">BE</option>
                                                        <option value="FR">FR</option>
                                                        <option value="NL">NL</option>
                                                        <option value="LU">LU</option>
                                                        <option value="CH">CH</option>
                                                        <option value="DE">DE</option>
                                                        <option value="IT">IT</option>
                                                        <option value="ES">ES</option>
                                                        <option value="PT">PT</option>
                                                    </select>
                                                </div>
                                                <div>
                                                    <label for="language" class="form-label">Language</label>
                                                    <input type="text" class="form-control" id="language" name="language" placeholder="en">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Latitude and Longitude -->
                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseLatLng" aria-expanded="false" aria-controls="collapseLatLng">
                                            <i class="bi bi-geo-alt-fill text-primary me-2"></i> Latitude & Longitude
                                        </button>
                                    </h2>
                                    <div id="collapseLatLng" class="accordion-collapse collapse" data-bs-parent="#configAccordion">
                                        <div class="accordion-body">
                                            <div class="row">
                                                <div>
                                                    <label for="latitude" class="form-label">Latitude</label>
                                                    <input type="text" class="form-control" id="latitude" name="latitude" placeholder="50.8503">
                                                    <div class="hint">Dot format. Commas are auto-converted to dots.</div>
                                                </div>
                                                <div>
                                                    <label for="longitude" class="form-label">Longitude</label>
                                                    <input type="text" class="form-control" id="longitude" name="longitude" placeholder="4.3517">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Pin or Circle -->
                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseMarkerType" aria-expanded="false" aria-controls="collapseMarkerType">
                                            <i class="bi bi-pin-map-fill text-primary me-2"></i> Pin or Circle
                                        </button>
                                    </h2>
                                    <div id="collapseMarkerType" class="accordion-collapse collapse" data-bs-parent="#configAccordion">
                                        <div class="accordion-body">
                                            <div class="radio-group">
                                                <div class="radio-option">
                                                    <input type="radio" name="markerType" id="pin" value="pin" checked>
                                                    <label for="pin">Pin</label>
                                                </div>
                                                <div class="radio-option">
                                                    <input type="radio" name="markerType" id="circle" value="circle">
                                                    <label for="circle">Circle</label>
                                                </div>
                                                <div class="radio-option">
                                                    <input type="radio" name="markerType" id="custom" value="custom">
                                                    <label for="custom">Custom marker</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Circle Radius -->
                                <div class="accordion-item" id="circleRadiusGroup" style="display: none;">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseCircleRadius" aria-expanded="false" aria-controls="collapseCircleRadius">
                                            <i class="bi bi-circle-fill text-primary me-2"></i> Circle Radius
                                        </button>
                                    </h2>
                                    <div id="collapseCircleRadius" class="accordion-collapse collapse" data-bs-parent="#configAccordion">
                                        <div class="accordion-body">
                                            <label for="circleRadius" class="form-label">Circle radius (meters)</label>
                                            <div class="rangeWrap">
                                                <input type="range" class="form-range" id="circleRadius" name="circleRadius" min="50" max="2000" value="500" step="50">
                                                <div class="rangeMeta">
                                                    <span>50</span>
                                                    <span id="radiusValue">500 m</span>
                                                    <span>2000</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Custom Marker URL -->
                                <div class="accordion-item" id="customMarkerGroup" style="display: none;">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseCustomMarker" aria-expanded="false" aria-controls="collapseCustomMarker">
                                            <i class="bi bi-image text-primary me-2"></i> Custom Marker
                                        </button>
                                    </h2>
                                    <div id="collapseCustomMarker" class="accordion-collapse collapse" data-bs-parent="#configAccordion">
                                        <div class="accordion-body">
                                            <label for="customMarkerUrl" class="form-label">Custom marker URL</label>
                                            <input type="url" class="form-control" id="customMarkerUrl" name="customMarkerUrl" placeholder="https://example.com/marker.png">
                                            <div class="hint">Direct image URL (png/svg/webp). Must be publicly accessible.</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Width -->
                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseWidth" aria-expanded="false" aria-controls="collapseWidth">
                                            <i class="bi bi-arrows-expand-horizontal text-primary me-2"></i> Width
                                        </button>
                                    </h2>
                                    <div id="collapseWidth" class="accordion-collapse collapse" data-bs-parent="#configAccordion">
                                        <div class="accordion-body">
                                            <label for="width" class="form-label">Width (px)</label>
                                            <input type="number" class="form-control" id="width" name="width" value="100" min="100" max="2000">
                                        </div>
                                    </div>
                                </div>

                                <!-- Height -->
                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHeight" aria-expanded="false" aria-controls="collapseHeight">
                                            <i class="bi bi-arrows-expand-vertical text-primary me-2"></i> Height
                                        </button>
                                    </h2>
                                    <div id="collapseHeight" class="accordion-collapse collapse" data-bs-parent="#configAccordion">
                                        <div class="accordion-body">
                                            <label for="height" class="form-label">Height (px)</label>
                                            <input type="number" class="form-control" id="height" name="height" value="520" min="200" max="2000">
                                        </div>
                                    </div>
                                </div>

                                <!-- Zoom Level -->
                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseZoom" aria-expanded="false" aria-controls="collapseZoom">
                                            <i class="bi bi-zoom-in text-primary me-2"></i> Zoom Level
                                        </button>
                                    </h2>
                                    <div id="collapseZoom" class="accordion-collapse collapse" data-bs-parent="#configAccordion">
                                        <div class="accordion-body">
                                            <label for="zoom" class="form-label">Zoom level</label>
                                            <div class="rangeWrap">
                                                <input type="range" class="form-range" id="zoom" name="zoom" min="2" max="20" value="15">
                                                <div class="rangeMeta">
                                                    <span>2</span>
                                                    <span id="zoomValue">15</span>
                                                    <span>20</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Accent Color and License Key -->
                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseAccentLicense" aria-expanded="false" aria-controls="collapseAccentLicense">
                                            <i class="bi bi-palette text-primary me-2"></i> Accent Color & License Key
                                        </button>
                                    </h2>
                                    <div id="collapseAccentLicense" class="accordion-collapse collapse" data-bs-parent="#configAccordion">
                                        <div class="accordion-body">
                                            <div class="row">
                                                <div>
                                                    <label class="form-label">Accent color</label>
                                                    <div class="color-picker-wrapper">
                                                        <input type="color" class="color-picker" id="accentColor" name="accentColor" value="#428BFF">
                                                        <input type="text" class="form-control" id="accentColorText" value="#428BFF">
                                                    </div>
                                                    <div class="hint">Pick a color or type a hex value. Default: #428BFF</div>
                                                </div>
                                                <div>
                                                    <label for="licenseKey" class="form-label">License key</label>
                                                    <input type="text" class="form-control" id="licenseKey" name="licenseKey" placeholder="Optional">
                                                    <div class="hint">Optional. Default key is used if empty.</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="codeBox">
                        <div class="top">
                            <strong>Copy-paste embed code</strong>
                            <button class="btn btn-copy" id="copyButton">Copy</button>
                        </div>
                        <textarea id="code" readonly></textarea>
                    </div>
                </div>
            </div>

            <div class="col-lg-4">
                <div class="preview-section">
                    <div class="head">
                        <h2>Live previews</h2>
                    </div>
                    <div class="body">
                        <div class="mb-4">
                            <div class="preview-container" style="height: 400px;">
                                <div style="padding: 0.5rem; background: #f8f9fa; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center;">
                                    <strong style="font-size: 14px;">Medium</strong>
                                    <span style="font-size: 12px; color: #6c757d;">Responsive</span>
                                </div>
                                <iframe class="preview-frame" id="previewMedium" style="height: calc(100% - 40px);"></iframe>
                            </div>
                        </div>

                        <div>
                            <div class="preview-container" style="width: 320px; height: 568px; margin: 0 auto;">
                                <div style="padding: 0.5rem; background: #f8f9fa; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center;">
                                    <strong style="font-size: 14px;">Mobile</strong>
                                    <span style="font-size: 12px; color: #6c757d;">320 Ã— 568</span>
                                </div>
                                <iframe class="preview-frame" id="previewMobile" style="height: calc(100% - 40px);"></iframe>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tips-section">
                    <div class="head">
                        <h2>Tips</h2>
                    </div>
                    <div class="body">
                        <div class="note">
                            For best results on client websites:
                            <ul>
                                <li>Set a fixed height (e.g. 520px) or a responsive height with CSS.</li>
                                <li>Use <code>loading="lazy"</code> for performance if desired.</li>
                                <li>Use HTTPS pages if you embed the plugin on HTTPS websites.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap 5 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Update accent color text when color picker changes
        document.getElementById('accentColor').addEventListener('input', function(e) {
            document.getElementById('accentColorText').value = e.target.value;
            updateEmbedCode();
        });

        // Update color picker when text input changes
        document.getElementById('accentColorText').addEventListener('input', function(e) {
            const color = e.target.value;
            if (/^#[0-9A-F]{6}$/i.test(color)) {
                document.getElementById('accentColor').value = color;
                updateEmbedCode();
            }
        });

        // Show/hide circle radius based on marker type
        document.querySelectorAll('input[name="markerType"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const circleRadiusGroup = document.getElementById('circleRadiusGroup');
                const customMarkerGroup = document.getElementById('customMarkerGroup');
                const circleCollapse = document.getElementById('collapseCircleRadius');
                const customCollapse = document.getElementById('collapseCustomMarker');
                
                // Collapse any open accordions before showing/hiding
                if (circleCollapse && circleCollapse.classList.contains('show')) {
                    const bsCollapse = bootstrap.Collapse.getInstance(circleCollapse);
                    if (bsCollapse) bsCollapse.hide();
                }
                if (customCollapse && customCollapse.classList.contains('show')) {
                    const bsCollapse = bootstrap.Collapse.getInstance(customCollapse);
                    if (bsCollapse) bsCollapse.hide();
                }
                
                if (this.value === 'circle') {
                    circleRadiusGroup.style.display = 'block';
                    customMarkerGroup.style.display = 'none';
                } else if (this.value === 'custom') {
                    circleRadiusGroup.style.display = 'none';
                    customMarkerGroup.style.display = 'block';
                } else {
                    circleRadiusGroup.style.display = 'none';
                    customMarkerGroup.style.display = 'none';
                }
                updateEmbedCode();
            });
        });

        // Update radius value display
        document.getElementById('circleRadius').addEventListener('input', function(e) {
            document.getElementById('radiusValue').textContent = e.target.value + ' m';
            updateEmbedCode();
        });

        // Update zoom value display
        document.getElementById('zoom').addEventListener('input', function(e) {
            document.getElementById('zoomValue').textContent = e.target.value;
            updateEmbedCode();
        });

        // Update embed code when any form field changes
        document.getElementById('pluginForm').addEventListener('input', updateEmbedCode);
        document.getElementById('pluginForm').addEventListener('change', updateEmbedCode);

        // Generate embed code
        function updateEmbedCode() {
            const form = document.getElementById('pluginForm');
            const formData = new FormData(form);
            
            const config = {
                style: formData.get('mapStyle') || '1',
                mode: formData.get('mode') || 'together',
                country: formData.get('country') || 'BE',
                language: formData.get('language') || 'en',
                latitude: formData.get('latitude') || '50.8503',
                longitude: formData.get('longitude') || '4.3517',
                markerType: formData.get('markerType') || 'pin',
                circleRadius: formData.get('circleRadius') || '500',
                customMarkerUrl: formData.get('customMarkerUrl') || '',
                width: formData.get('width') || '100',
                height: formData.get('height') || '520',
                zoom: formData.get('zoom') || '15',
                accentColor: document.getElementById('accentColor').value || '#428BFF',
                licenseKey: formData.get('licenseKey') || ''
            };

            // Build URL parameters
            const params = new URLSearchParams();
            params.append('style', config.style);
            params.append('mode', config.mode);
            params.append('country', config.country);
            params.append('lang', config.language);
            params.append('lat', config.latitude.replace(',', '.'));
            params.append('lng', config.longitude.replace(',', '.'));
            params.append('zoom', config.zoom);
            params.append('accent', config.accentColor);
            params.append('width', config.width + '%');
            params.append('height', config.height + 'px');

            if (config.markerType === 'circle') {
                params.append('radius', config.circleRadius);
            } else if (config.markerType === 'custom' && config.customMarkerUrl) {
                params.append('marker', config.customMarkerUrl);
            }

            if (config.licenseKey) {
                params.append('key', config.licenseKey);
            }

            const embedUrl = `https://map.yatmo.com/embed?${params.toString()}`;
            
            const embedCode = `<iframe 
  src="${embedUrl}"
  width="${config.width}%"
  height="${config.height}"
  frameborder="0"
  style="border:0;"
  allowfullscreen
  loading="lazy">
</iframe>`;

            document.getElementById('code').value = embedCode;
            
            // Update previews
            document.getElementById('previewMedium').src = embedUrl;
            document.getElementById('previewMobile').src = embedUrl;
        }

        // Copy to clipboard
        document.getElementById('copyButton').addEventListener('click', function() {
            const code = document.getElementById('code').value;
            navigator.clipboard.writeText(code).then(() => {
                const btn = this;
                const originalText = btn.innerHTML;
                btn.innerHTML = '<i class="bi bi-check"></i> Copied!';
                btn.classList.add('btn-success');
                btn.classList.remove('btn-copy');
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.classList.remove('btn-success');
                    btn.classList.add('btn-copy');
                }, 2000);
            });
        });

        // Initialize on page load
        updateEmbedCode();
    </script>
</body>
</html>
